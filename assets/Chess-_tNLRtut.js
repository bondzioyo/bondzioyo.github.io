var zt=Object.defineProperty;var Yt=(t,e,o)=>e in t?zt(t,e,{enumerable:!0,configurable:!0,writable:!0,value:o}):t[e]=o;var x=(t,e,o)=>(Yt(t,typeof e!="symbol"?e+"":e,o),o);import{h as ct,r as ue,i as ze,j as ht,k as Zt,o as F,c as Z,a as C,l as dt,m as ut,n as Re,F as Ne,b as pt,p as Xt,M as Jt,t as re,f as ft,u as eo}from"./index-NPbT2qNs.js";const to={class:"promotion-dialog",open:""},oo=["aria-label","onClick","onTouchstartPassive"],so=ct({__name:"PromotionDialog",props:{state:{}},emits:["promotionSelected"],setup(t,{emit:e}){const o=t,s=[{name:"Queen",data:"q"},{name:"Knight",data:"n"},{name:"Rook",data:"r"},{name:"Bishop",data:"b"}];function i(n){var r,a;(a=(r=o.state).callback)==null||a.call(r,n.data),e("promotionSelected")}return(n,r)=>(F(),Z("dialog",to,[(F(),Z(Ne,null,pt(s,a=>C("button",{key:a.name,type:"button",class:Re([a.name.toLowerCase(),n.state.color]),"aria-label":a.name,onClick:l=>i(a),onTouchstartPassive:l=>i(a)},null,42,oo)),64))]))}});/**
 * @license
 * Copyright (c) 2023, Jeff Hlywa (jhlywa@gmail.com)
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, with or without
 * modification, are permitted provided that the following conditions are met:
 *
 * 1. Redistributions of source code must retain the above copyright notice,
 *    this list of conditions and the following disclaimer.
 * 2. Redistributions in binary form must reproduce the above copyright notice,
 *    this list of conditions and the following disclaimer in the documentation
 *    and/or other materials provided with the distribution.
 *
 * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS"
 * AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
 * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
 * ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE
 * LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR
 * CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF
 * SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS
 * INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN
 * CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
 * ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
 * POSSIBILITY OF SUCH DAMAGE.
 */const T="w",R="b",M="p",Ie="n",we="b",de="r",Y="q",P="k",Ee="rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR w KQkq - 0 1",L=-1,io={NORMAL:"n",CAPTURE:"c",BIG_PAWN:"b",EP_CAPTURE:"e",PROMOTION:"p",KSIDE_CASTLE:"k",QSIDE_CASTLE:"q"},no=["a8","b8","c8","d8","e8","f8","g8","h8","a7","b7","c7","d7","e7","f7","g7","h7","a6","b6","c6","d6","e6","f6","g6","h6","a5","b5","c5","d5","e5","f5","g5","h5","a4","b4","c4","d4","e4","f4","g4","h4","a3","b3","c3","d3","e3","f3","g3","h3","a2","b2","c2","d2","e2","f2","g2","h2","a1","b1","c1","d1","e1","f1","g1","h1"],b={NORMAL:1,CAPTURE:2,BIG_PAWN:4,EP_CAPTURE:8,PROMOTION:16,KSIDE_CASTLE:32,QSIDE_CASTLE:64},v={a8:0,b8:1,c8:2,d8:3,e8:4,f8:5,g8:6,h8:7,a7:16,b7:17,c7:18,d7:19,e7:20,f7:21,g7:22,h7:23,a6:32,b6:33,c6:34,d6:35,e6:36,f6:37,g6:38,h6:39,a5:48,b5:49,c5:50,d5:51,e5:52,f5:53,g5:54,h5:55,a4:64,b4:65,c4:66,d4:67,e4:68,f4:69,g4:70,h4:71,a3:80,b3:81,c3:82,d3:83,e3:84,f3:85,g3:86,h3:87,a2:96,b2:97,c2:98,d2:99,e2:100,f2:101,g2:102,h2:103,a1:112,b1:113,c1:114,d1:115,e1:116,f1:117,g1:118,h1:119},Me={b:[16,32,17,15],w:[-16,-32,-17,-15]},Ye={n:[-18,-33,-31,-14,18,33,31,14],b:[-17,-15,17,15],r:[-16,1,16,-1],q:[-17,-16,-15,1,17,16,15,-1],k:[-17,-16,-15,1,17,16,15,-1]},ro=[20,0,0,0,0,0,0,24,0,0,0,0,0,0,20,0,0,20,0,0,0,0,0,24,0,0,0,0,0,20,0,0,0,0,20,0,0,0,0,24,0,0,0,0,20,0,0,0,0,0,0,20,0,0,0,24,0,0,0,20,0,0,0,0,0,0,0,0,20,0,0,24,0,0,20,0,0,0,0,0,0,0,0,0,0,20,2,24,2,20,0,0,0,0,0,0,0,0,0,0,0,2,53,56,53,2,0,0,0,0,0,0,24,24,24,24,24,24,56,0,56,24,24,24,24,24,24,0,0,0,0,0,0,2,53,56,53,2,0,0,0,0,0,0,0,0,0,0,0,20,2,24,2,20,0,0,0,0,0,0,0,0,0,0,20,0,0,24,0,0,20,0,0,0,0,0,0,0,0,20,0,0,0,24,0,0,0,20,0,0,0,0,0,0,20,0,0,0,0,24,0,0,0,0,20,0,0,0,0,20,0,0,0,0,0,24,0,0,0,0,0,20,0,0,20,0,0,0,0,0,0,24,0,0,0,0,0,0,20],ao=[17,0,0,0,0,0,0,16,0,0,0,0,0,0,15,0,0,17,0,0,0,0,0,16,0,0,0,0,0,15,0,0,0,0,17,0,0,0,0,16,0,0,0,0,15,0,0,0,0,0,0,17,0,0,0,16,0,0,0,15,0,0,0,0,0,0,0,0,17,0,0,16,0,0,15,0,0,0,0,0,0,0,0,0,0,17,0,16,0,15,0,0,0,0,0,0,0,0,0,0,0,0,17,16,15,0,0,0,0,0,0,0,1,1,1,1,1,1,1,0,-1,-1,-1,-1,-1,-1,-1,0,0,0,0,0,0,0,-15,-16,-17,0,0,0,0,0,0,0,0,0,0,0,0,-15,0,-16,0,-17,0,0,0,0,0,0,0,0,0,0,-15,0,0,-16,0,0,-17,0,0,0,0,0,0,0,0,-15,0,0,0,-16,0,0,0,-17,0,0,0,0,0,0,-15,0,0,0,0,-16,0,0,0,0,-17,0,0,0,0,-15,0,0,0,0,0,-16,0,0,0,0,0,-17,0,0,-15,0,0,0,0,0,0,-16,0,0,0,0,0,0,-17],lo={p:1,n:2,b:4,r:8,q:16,k:32},co="pnbrqkPNBRQK",Ze=[Ie,we,de,Y],ho=7,uo=6,po=1,fo=0,ve={[P]:b.KSIDE_CASTLE,[Y]:b.QSIDE_CASTLE},U={w:[{square:v.a1,flag:b.QSIDE_CASTLE},{square:v.h1,flag:b.KSIDE_CASTLE}],b:[{square:v.a8,flag:b.QSIDE_CASTLE},{square:v.h8,flag:b.KSIDE_CASTLE}]},go={b:po,w:uo},mo=["1-0","0-1","1/2-1/2","*"];function te(t){return t>>4}function pe(t){return t&15}function gt(t){return"0123456789".indexOf(t)!==-1}function O(t){const e=pe(t),o=te(t);return"abcdefgh".substring(e,e+1)+"87654321".substring(o,o+1)}function le(t){return t===T?R:T}function bo(t){const e=t.split(/\s+/);if(e.length!==6)return{ok:!1,error:"Invalid FEN: must contain six space-delimited fields"};const o=parseInt(e[5],10);if(isNaN(o)||o<=0)return{ok:!1,error:"Invalid FEN: move number must be a positive integer"};const s=parseInt(e[4],10);if(isNaN(s)||s<0)return{ok:!1,error:"Invalid FEN: half move counter number must be a non-negative integer"};if(!/^(-|[abcdefgh][36])$/.test(e[3]))return{ok:!1,error:"Invalid FEN: en-passant square is invalid"};if(/[^kKqQ-]/.test(e[2]))return{ok:!1,error:"Invalid FEN: castling availability is invalid"};if(!/^(w|b)$/.test(e[1]))return{ok:!1,error:"Invalid FEN: side-to-move is invalid"};const i=e[0].split("/");if(i.length!==8)return{ok:!1,error:"Invalid FEN: piece data does not contain 8 '/'-delimited rows"};for(let r=0;r<i.length;r++){let a=0,l=!1;for(let c=0;c<i[r].length;c++)if(gt(i[r][c])){if(l)return{ok:!1,error:"Invalid FEN: piece data is invalid (consecutive number)"};a+=parseInt(i[r][c],10),l=!0}else{if(!/^[prnbqkPRNBQK]$/.test(i[r][c]))return{ok:!1,error:"Invalid FEN: piece data is invalid (invalid piece)"};a+=1,l=!1}if(a!==8)return{ok:!1,error:"Invalid FEN: piece data is invalid (too many squares in rank)"}}if(e[3][1]=="3"&&e[1]=="w"||e[3][1]=="6"&&e[1]=="b")return{ok:!1,error:"Invalid FEN: illegal en-passant square"};const n=[{color:"white",regex:/K/g},{color:"black",regex:/k/g}];for(const{color:r,regex:a}of n){if(!a.test(e[0]))return{ok:!1,error:`Invalid FEN: missing ${r} king`};if((e[0].match(a)||[]).length>1)return{ok:!1,error:`Invalid FEN: too many ${r} kings`}}return{ok:!0}}function vo(t,e){const o=t.from,s=t.to,i=t.piece;let n=0,r=0,a=0;for(let l=0,c=e.length;l<c;l++){const p=e[l].from,u=e[l].to,h=e[l].piece;i===h&&o!==p&&s===u&&(n++,te(o)===te(p)&&r++,pe(o)===pe(p)&&a++)}return n>0?r>0&&a>0?O(o):a>0?O(o).charAt(1):O(o).charAt(0):""}function G(t,e,o,s,i,n=void 0,r=b.NORMAL){const a=te(s);if(i===M&&(a===ho||a===fo))for(let l=0;l<Ze.length;l++){const c=Ze[l];t.push({color:e,from:o,to:s,piece:i,captured:n,promotion:c,flags:r|b.PROMOTION})}else t.push({color:e,from:o,to:s,piece:i,captured:n,flags:r})}function Xe(t){let e=t.charAt(0);return e>="a"&&e<="h"?t.match(/[a-h]\d.*[a-h]\d/)?void 0:M:(e=e.toLowerCase(),e==="o"?P:e)}function Pe(t){return t.replace(/=/,"").replace(/[+#]?[?!]*$/,"")}class _o{constructor(e=Ee){x(this,"_board",new Array(128));x(this,"_turn",T);x(this,"_header",{});x(this,"_kings",{w:L,b:L});x(this,"_epSquare",-1);x(this,"_halfMoves",0);x(this,"_moveNumber",0);x(this,"_history",[]);x(this,"_comments",{});x(this,"_castling",{w:0,b:0});this.load(e)}clear(e=!1){this._board=new Array(128),this._kings={w:L,b:L},this._turn=T,this._castling={w:0,b:0},this._epSquare=L,this._halfMoves=0,this._moveNumber=1,this._history=[],this._comments={},this._header=e?this._header:{},this._updateSetup(this.fen())}removeHeader(e){e in this._header&&delete this._header[e]}load(e,o=!1){let s=e.split(/\s+/);if(s.length>=2&&s.length<6){const l=["-","-","0","1"];e=s.concat(l.slice(-(6-s.length))).join(" ")}s=e.split(/\s+/);const{ok:i,error:n}=bo(e);if(!i)throw new Error(n);const r=s[0];let a=0;this.clear(o);for(let l=0;l<r.length;l++){const c=r.charAt(l);if(c==="/")a+=8;else if(gt(c))a+=parseInt(c,10);else{const p=c<"a"?T:R;this.put({type:c.toLowerCase(),color:p},O(a)),a++}}this._turn=s[1],s[2].indexOf("K")>-1&&(this._castling.w|=b.KSIDE_CASTLE),s[2].indexOf("Q")>-1&&(this._castling.w|=b.QSIDE_CASTLE),s[2].indexOf("k")>-1&&(this._castling.b|=b.KSIDE_CASTLE),s[2].indexOf("q")>-1&&(this._castling.b|=b.QSIDE_CASTLE),this._epSquare=s[3]==="-"?L:v[s[3]],this._halfMoves=parseInt(s[4],10),this._moveNumber=parseInt(s[5],10),this._updateSetup(this.fen())}fen(){var n,r;let e=0,o="";for(let a=v.a8;a<=v.h1;a++){if(this._board[a]){e>0&&(o+=e,e=0);const{color:l,type:c}=this._board[a];o+=l===T?c.toUpperCase():c.toLowerCase()}else e++;a+1&136&&(e>0&&(o+=e),a!==v.h1&&(o+="/"),e=0,a+=8)}let s="";this._castling[T]&b.KSIDE_CASTLE&&(s+="K"),this._castling[T]&b.QSIDE_CASTLE&&(s+="Q"),this._castling[R]&b.KSIDE_CASTLE&&(s+="k"),this._castling[R]&b.QSIDE_CASTLE&&(s+="q"),s=s||"-";let i="-";if(this._epSquare!==L){const a=this._epSquare+(this._turn===T?16:-16),l=[a+1,a-1];for(const c of l){if(c&136)continue;const p=this._turn;if(((n=this._board[c])==null?void 0:n.color)===p&&((r=this._board[c])==null?void 0:r.type)===M){this._makeMove({color:p,from:c,to:this._epSquare,piece:M,captured:M,flags:b.EP_CAPTURE});const u=!this._isKingAttacked(p);if(this._undoMove(),u){i=O(this._epSquare);break}}}}return[o,this._turn,s,i,this._halfMoves,this._moveNumber].join(" ")}_updateSetup(e){this._history.length>0||(e!==Ee?(this._header.SetUp="1",this._header.FEN=e):(delete this._header.SetUp,delete this._header.FEN))}reset(){this.load(Ee)}get(e){return this._board[v[e]]||!1}put({type:e,color:o},s){if(co.indexOf(e.toLowerCase())===-1||!(s in v))return!1;const i=v[s];return e==P&&!(this._kings[o]==L||this._kings[o]==i)?!1:(this._board[i]={type:e,color:o},e===P&&(this._kings[o]=i),this._updateCastlingRights(),this._updateEnPassantSquare(),this._updateSetup(this.fen()),!0)}remove(e){const o=this.get(e);return delete this._board[v[e]],o&&o.type===P&&(this._kings[o.color]=L),this._updateCastlingRights(),this._updateEnPassantSquare(),this._updateSetup(this.fen()),o}_updateCastlingRights(){var s,i,n,r,a,l,c,p,u,h,g,d;const e=((s=this._board[v.e1])==null?void 0:s.type)===P&&((i=this._board[v.e1])==null?void 0:i.color)===T,o=((n=this._board[v.e8])==null?void 0:n.type)===P&&((r=this._board[v.e8])==null?void 0:r.color)===R;(!e||((a=this._board[v.a1])==null?void 0:a.type)!==de||((l=this._board[v.a1])==null?void 0:l.color)!==T)&&(this._castling.w&=~b.QSIDE_CASTLE),(!e||((c=this._board[v.h1])==null?void 0:c.type)!==de||((p=this._board[v.h1])==null?void 0:p.color)!==T)&&(this._castling.w&=~b.KSIDE_CASTLE),(!o||((u=this._board[v.a8])==null?void 0:u.type)!==de||((h=this._board[v.a8])==null?void 0:h.color)!==R)&&(this._castling.b&=~b.QSIDE_CASTLE),(!o||((g=this._board[v.h8])==null?void 0:g.type)!==de||((d=this._board[v.h8])==null?void 0:d.color)!==R)&&(this._castling.b&=~b.KSIDE_CASTLE)}_updateEnPassantSquare(){var n,r;if(this._epSquare===L)return;const e=this._epSquare+(this._turn===T?-16:16),o=this._epSquare+(this._turn===T?16:-16),s=[o+1,o-1];if(this._board[e]!==null||this._board[this._epSquare]!==null||((n=this._board[o])==null?void 0:n.color)!==le(this._turn)||((r=this._board[o])==null?void 0:r.type)!==M){this._epSquare=L;return}const i=a=>{var l,c;return!(a&136)&&((l=this._board[a])==null?void 0:l.color)===this._turn&&((c=this._board[a])==null?void 0:c.type)===M};s.some(i)||(this._epSquare=L)}_attacked(e,o){for(let s=v.a8;s<=v.h1;s++){if(s&136){s+=7;continue}if(this._board[s]===void 0||this._board[s].color!==e)continue;const i=this._board[s],n=s-o;if(n===0)continue;const r=n+119;if(ro[r]&lo[i.type]){if(i.type===M){if(n>0){if(i.color===T)return!0}else if(i.color===R)return!0;continue}if(i.type==="n"||i.type==="k")return!0;const a=ao[r];let l=s+a,c=!1;for(;l!==o;){if(this._board[l]!=null){c=!0;break}l+=a}if(!c)return!0}}return!1}_isKingAttacked(e){const o=this._kings[e];return o===-1?!1:this._attacked(le(e),o)}isAttacked(e,o){return this._attacked(o,v[e])}isCheck(){return this._isKingAttacked(this._turn)}inCheck(){return this.isCheck()}isCheckmate(){return this.isCheck()&&this._moves().length===0}isStalemate(){return!this.isCheck()&&this._moves().length===0}isInsufficientMaterial(){const e={b:0,n:0,r:0,q:0,k:0,p:0},o=[];let s=0,i=0;for(let n=v.a8;n<=v.h1;n++){if(i=(i+1)%2,n&136){n+=7;continue}const r=this._board[n];r&&(e[r.type]=r.type in e?e[r.type]+1:1,r.type===we&&o.push(i),s++)}if(s===2||s===3&&(e[we]===1||e[Ie]===1))return!0;if(s===e[we]+2){let n=0;const r=o.length;for(let a=0;a<r;a++)n+=o[a];if(n===0||n===r)return!0}return!1}isThreefoldRepetition(){const e=[],o={};let s=!1;for(;;){const i=this._undoMove();if(!i)break;e.push(i)}for(;;){const i=this.fen().split(" ").slice(0,4).join(" ");o[i]=i in o?o[i]+1:1,o[i]>=3&&(s=!0);const n=e.pop();if(n)this._makeMove(n);else break}return s}isDraw(){return this._halfMoves>=100||this.isStalemate()||this.isInsufficientMaterial()||this.isThreefoldRepetition()}isGameOver(){return this.isCheckmate()||this.isStalemate()||this.isDraw()}moves({verbose:e=!1,square:o=void 0,piece:s=void 0}={}){const i=this._moves({square:o,piece:s});return e?i.map(n=>this._makePretty(n)):i.map(n=>this._moveToSan(n,i))}_moves({legal:e=!0,piece:o=void 0,square:s=void 0}={}){var g;const i=s?s.toLowerCase():void 0,n=o==null?void 0:o.toLowerCase(),r=[],a=this._turn,l=le(a);let c=v.a8,p=v.h1,u=!1;if(i)if(i in v)c=p=v[i],u=!0;else return[];for(let d=c;d<=p;d++){if(d&136){d+=7;continue}if(!this._board[d]||this._board[d].color===l)continue;const{type:f}=this._board[d];let _;if(f===M){if(n&&n!==f)continue;_=d+Me[a][0],this._board[_]||(G(r,a,d,_,M),_=d+Me[a][1],go[a]===te(d)&&!this._board[_]&&G(r,a,d,_,M,void 0,b.BIG_PAWN));for(let y=2;y<4;y++)_=d+Me[a][y],!(_&136)&&(((g=this._board[_])==null?void 0:g.color)===l?G(r,a,d,_,M,this._board[_].type,b.CAPTURE):_===this._epSquare&&G(r,a,d,_,M,M,b.EP_CAPTURE))}else{if(n&&n!==f)continue;for(let y=0,m=Ye[f].length;y<m;y++){const S=Ye[f][y];for(_=d;_+=S,!(_&136);){if(!this._board[_])G(r,a,d,_,f);else{if(this._board[_].color===a)break;G(r,a,d,_,f,this._board[_].type,b.CAPTURE);break}if(f===Ie||f===P)break}}}}if((n===void 0||n===P)&&(!u||p===this._kings[a])){if(this._castling[a]&b.KSIDE_CASTLE){const d=this._kings[a],f=d+2;!this._board[d+1]&&!this._board[f]&&!this._attacked(l,this._kings[a])&&!this._attacked(l,d+1)&&!this._attacked(l,f)&&G(r,a,this._kings[a],f,P,void 0,b.KSIDE_CASTLE)}if(this._castling[a]&b.QSIDE_CASTLE){const d=this._kings[a],f=d-2;!this._board[d-1]&&!this._board[d-2]&&!this._board[d-3]&&!this._attacked(l,this._kings[a])&&!this._attacked(l,d-1)&&!this._attacked(l,f)&&G(r,a,this._kings[a],f,P,void 0,b.QSIDE_CASTLE)}}if(!e||this._kings[a]===-1)return r;const h=[];for(let d=0,f=r.length;d<f;d++)this._makeMove(r[d]),this._isKingAttacked(a)||h.push(r[d]),this._undoMove();return h}move(e,{strict:o=!1}={}){let s=null;if(typeof e=="string")s=this._moveFromSan(e,o);else if(typeof e=="object"){const n=this._moves();for(let r=0,a=n.length;r<a;r++)if(e.from===O(n[r].from)&&e.to===O(n[r].to)&&(!("promotion"in n[r])||e.promotion===n[r].promotion)){s=n[r];break}}if(!s)throw typeof e=="string"?new Error(`Invalid move: ${e}`):new Error(`Invalid move: ${JSON.stringify(e)}`);const i=this._makePretty(s);return this._makeMove(s),i}_push(e){this._history.push({move:e,kings:{b:this._kings.b,w:this._kings.w},turn:this._turn,castling:{b:this._castling.b,w:this._castling.w},epSquare:this._epSquare,halfMoves:this._halfMoves,moveNumber:this._moveNumber})}_makeMove(e){const o=this._turn,s=le(o);if(this._push(e),this._board[e.to]=this._board[e.from],delete this._board[e.from],e.flags&b.EP_CAPTURE&&(this._turn===R?delete this._board[e.to-16]:delete this._board[e.to+16]),e.promotion&&(this._board[e.to]={type:e.promotion,color:o}),this._board[e.to].type===P){if(this._kings[o]=e.to,e.flags&b.KSIDE_CASTLE){const i=e.to-1,n=e.to+1;this._board[i]=this._board[n],delete this._board[n]}else if(e.flags&b.QSIDE_CASTLE){const i=e.to+1,n=e.to-2;this._board[i]=this._board[n],delete this._board[n]}this._castling[o]=0}if(this._castling[o]){for(let i=0,n=U[o].length;i<n;i++)if(e.from===U[o][i].square&&this._castling[o]&U[o][i].flag){this._castling[o]^=U[o][i].flag;break}}if(this._castling[s]){for(let i=0,n=U[s].length;i<n;i++)if(e.to===U[s][i].square&&this._castling[s]&U[s][i].flag){this._castling[s]^=U[s][i].flag;break}}e.flags&b.BIG_PAWN?o===R?this._epSquare=e.to-16:this._epSquare=e.to+16:this._epSquare=L,e.piece===M?this._halfMoves=0:e.flags&(b.CAPTURE|b.EP_CAPTURE)?this._halfMoves=0:this._halfMoves++,o===R&&this._moveNumber++,this._turn=s}undo(){const e=this._undoMove();return e?this._makePretty(e):null}_undoMove(){const e=this._history.pop();if(e===void 0)return null;const o=e.move;this._kings=e.kings,this._turn=e.turn,this._castling=e.castling,this._epSquare=e.epSquare,this._halfMoves=e.halfMoves,this._moveNumber=e.moveNumber;const s=this._turn,i=le(s);if(this._board[o.from]=this._board[o.to],this._board[o.from].type=o.piece,delete this._board[o.to],o.captured)if(o.flags&b.EP_CAPTURE){let n;s===R?n=o.to-16:n=o.to+16,this._board[n]={type:M,color:i}}else this._board[o.to]={type:o.captured,color:i};if(o.flags&(b.KSIDE_CASTLE|b.QSIDE_CASTLE)){let n,r;o.flags&b.KSIDE_CASTLE?(n=o.to+1,r=o.to-1):(n=o.to-2,r=o.to+1),this._board[n]=this._board[r],delete this._board[r]}return o}pgn({newline:e=`
`,maxWidth:o=0}={}){const s=[];let i=!1;for(const h in this._header)s.push("["+h+' "'+this._header[h]+'"]'+e),i=!0;i&&this._history.length&&s.push(e);const n=h=>{const g=this._comments[this.fen()];if(typeof g<"u"){const d=h.length>0?" ":"";h=`${h}${d}{${g}}`}return h},r=[];for(;this._history.length>0;)r.push(this._undoMove());const a=[];let l="";for(r.length===0&&a.push(n(""));r.length>0;){l=n(l);const h=r.pop();if(!h)break;if(!this._history.length&&h.color==="b"){const g=`${this._moveNumber}. ...`;l=l?`${l} ${g}`:g}else h.color==="w"&&(l.length&&a.push(l),l=this._moveNumber+".");l=l+" "+this._moveToSan(h,this._moves({legal:!0})),this._makeMove(h)}if(l.length&&a.push(n(l)),typeof this._header.Result<"u"&&a.push(this._header.Result),o===0)return s.join("")+a.join(" ");const c=function(){return s.length>0&&s[s.length-1]===" "?(s.pop(),!0):!1},p=function(h,g){for(const d of g.split(" "))if(d){if(h+d.length>o){for(;c();)h--;s.push(e),h=0}s.push(d),h+=d.length,s.push(" "),h++}return c()&&h--,h};let u=0;for(let h=0;h<a.length;h++){if(u+a[h].length>o&&a[h].includes("{")){u=p(u,a[h]);continue}u+a[h].length>o&&h!==0?(s[s.length-1]===" "&&s.pop(),s.push(e),u=0):h!==0&&(s.push(" "),u++),s.push(a[h]),u+=a[h].length}return s.join("")}header(...e){for(let o=0;o<e.length;o+=2)typeof e[o]=="string"&&typeof e[o+1]=="string"&&(this._header[e[o]]=e[o+1]);return this._header}loadPgn(e,{strict:o=!1,newlineChar:s=`\r?
`}={}){function i(m){return m.replace(/\\/g,"\\")}function n(m){const S={},D=m.split(new RegExp(i(s)));let N="",ne="";for(let W=0;W<D.length;W++){const w=/^\s*\[\s*([A-Za-z]+)\s*"(.*)"\s*\]\s*$/;N=D[W].replace(w,"$1"),ne=D[W].replace(w,"$2"),N.trim().length>0&&(S[N]=ne)}return S}e=e.trim();const r=new RegExp("^(\\[((?:"+i(s)+")|.)*\\])((?:\\s*"+i(s)+"){2}|(?:\\s*"+i(s)+")*$)").exec(e),a=r&&r.length>=2?r[1]:"";this.reset();const l=n(a);let c="";for(const m in l)m.toLowerCase()==="fen"&&(c=l[m]),this.header(m,l[m]);if(!o)c&&this.load(c,!0);else if(l.SetUp==="1"){if(!("FEN"in l))throw new Error("Invalid PGN: FEN tag must be supplied with SetUp tag");this.load(l.FEN,!0)}function p(m){return Array.from(m).map(function(S){return S.charCodeAt(0)<128?S.charCodeAt(0).toString(16):encodeURIComponent(S).replace(/%/g,"").toLowerCase()}).join("")}function u(m){return m.length==0?"":decodeURIComponent("%"+(m.match(/.{1,2}/g)||[]).join("%"))}const h=function(m){return m=m.replace(new RegExp(i(s),"g")," "),`{${p(m.slice(1,m.length-1))}}`},g=function(m){if(m.startsWith("{")&&m.endsWith("}"))return u(m.slice(1,m.length-1))};let d=e.replace(a,"").replace(new RegExp(`({[^}]*})+?|;([^${i(s)}]*)`,"g"),function(m,S,D){return S!==void 0?h(S):" "+h(`{${D.slice(1)}}`)}).replace(new RegExp(i(s),"g")," ");const f=/(\([^()]+\))+?/g;for(;f.test(d);)d=d.replace(f,"");d=d.replace(/\d+\.(\.\.)?/g,""),d=d.replace(/\.\.\./g,""),d=d.replace(/\$\d+/g,"");let _=d.trim().split(new RegExp(/\s+/));_=_.filter(m=>m!=="");let y="";for(let m=0;m<_.length;m++){const S=g(_[m]);if(S!==void 0){this._comments[this.fen()]=S;continue}const D=this._moveFromSan(_[m],o);if(D==null)if(mo.indexOf(_[m])>-1)y=_[m];else throw new Error(`Invalid move in PGN: ${_[m]}`);else y="",this._makeMove(D)}y&&Object.keys(this._header).length&&!this._header.Result&&this.header("Result",y)}_moveToSan(e,o){let s="";if(e.flags&b.KSIDE_CASTLE)s="O-O";else if(e.flags&b.QSIDE_CASTLE)s="O-O-O";else{if(e.piece!==M){const i=vo(e,o);s+=e.piece.toUpperCase()+i}e.flags&(b.CAPTURE|b.EP_CAPTURE)&&(e.piece===M&&(s+=O(e.from)[0]),s+="x"),s+=O(e.to),e.promotion&&(s+="="+e.promotion.toUpperCase())}return this._makeMove(e),this.isCheck()&&(this.isCheckmate()?s+="#":s+="+"),this._undoMove(),s}_moveFromSan(e,o=!1){const s=Pe(e);let i=Xe(s),n=this._moves({legal:!0,piece:i});for(let h=0,g=n.length;h<g;h++)if(s===Pe(this._moveToSan(n[h],n)))return n[h];if(o)return null;let r,a,l,c,p,u=!1;if(a=s.match(/([pnbrqkPNBRQK])?([a-h][1-8])x?-?([a-h][1-8])([qrbnQRBN])?/),a?(r=a[1],l=a[2],c=a[3],p=a[4],l.length==1&&(u=!0)):(a=s.match(/([pnbrqkPNBRQK])?([a-h]?[1-8]?)x?-?([a-h][1-8])([qrbnQRBN])?/),a&&(r=a[1],l=a[2],c=a[3],p=a[4],l.length==1&&(u=!0))),i=Xe(s),n=this._moves({legal:!0,piece:r||i}),!c)return null;for(let h=0,g=n.length;h<g;h++)if(l){if((!r||r.toLowerCase()==n[h].piece)&&v[l]==n[h].from&&v[c]==n[h].to&&(!p||p.toLowerCase()==n[h].promotion))return n[h];if(u){const d=O(n[h].from);if((!r||r.toLowerCase()==n[h].piece)&&v[c]==n[h].to&&(l==d[0]||l==d[1])&&(!p||p.toLowerCase()==n[h].promotion))return n[h]}}else if(s===Pe(this._moveToSan(n[h],n)).replace("x",""))return n[h];return null}ascii(){let e=`   +------------------------+
`;for(let o=v.a8;o<=v.h1;o++){if(pe(o)===0&&(e+=" "+"87654321"[te(o)]+" |"),this._board[o]){const s=this._board[o].type,i=this._board[o].color===T?s.toUpperCase():s.toLowerCase();e+=" "+i+" "}else e+=" . ";o+1&136&&(e+=`|
`,o+=8)}return e+=`   +------------------------+
`,e+="     a  b  c  d  e  f  g  h",e}perft(e){const o=this._moves({legal:!1});let s=0;const i=this._turn;for(let n=0,r=o.length;n<r;n++)this._makeMove(o[n]),this._isKingAttacked(i)||(e-1>0?s+=this.perft(e-1):s++),this._undoMove();return s}_makePretty(e){const{color:o,piece:s,from:i,to:n,flags:r,captured:a,promotion:l}=e;let c="";for(const g in b)b[g]&r&&(c+=io[g]);const p=O(i),u=O(n),h={color:o,piece:s,from:p,to:u,san:this._moveToSan(e,this._moves({legal:!0})),flags:c,lan:p+u,before:this.fen(),after:""};return this._makeMove(e),h.after=this.fen(),this._undoMove(),a&&(h.captured=a),l&&(h.promotion=l,h.lan+=l),h}turn(){return this._turn}board(){const e=[];let o=[];for(let s=v.a8;s<=v.h1;s++)this._board[s]==null?o.push(null):o.push({square:O(s),type:this._board[s].type,color:this._board[s].color}),s+1&136&&(e.push(o),o=[],s+=8);return e}squareColor(e){if(e in v){const o=v[e];return(te(o)+pe(o))%2===0?"light":"dark"}return null}history({verbose:e=!1}={}){const o=[],s=[];for(;this._history.length>0;)o.push(this._undoMove());for(;;){const i=o.pop();if(!i)break;e?s.push(this._makePretty(i)):s.push(this._moveToSan(i,this._moves())),this._makeMove(i)}return s}_pruneComments(){const e=[],o={},s=i=>{i in this._comments&&(o[i]=this._comments[i])};for(;this._history.length>0;)e.push(this._undoMove());for(s(this.fen());;){const i=e.pop();if(!i)break;this._makeMove(i),s(this.fen())}this._comments=o}getComment(){return this._comments[this.fen()]}setComment(e){this._comments[this.fen()]=e.replace("{","[").replace("}","]")}deleteComment(){const e=this._comments[this.fen()];return delete this._comments[this.fen()],e}getComments(){return this._pruneComments(),Object.keys(this._comments).map(e=>({fen:e,comment:this._comments[e]}))}deleteComments(){return this._pruneComments(),Object.keys(this._comments).map(e=>{const o=this._comments[e];return delete this._comments[e],{fen:e,comment:o}})}setCastlingRights(e,o){for(const i of[P,Y])o[i]!==void 0&&(o[i]?this._castling[e]|=ve[i]:this._castling[e]&=~ve[i]);this._updateCastlingRights();const s=this.getCastlingRights(e);return(o[P]===void 0||o[P]===s[P])&&(o[Y]===void 0||o[Y]===s[Y])}getCastlingRights(e){return{[P]:(this._castling[e]&ve[P])!==0,[Y]:(this._castling[e]&ve[Y])!==0}}moveNumber(){return this._moveNumber}}function wo(t){const e=[];for(const o of t)e.push({orig:o.to,brush:"yellow"}),o.captured&&e.push({orig:o.from,dest:o.to,brush:"red"}),o.san.includes("+")&&e.push({orig:o.from,dest:o.to,brush:"blue"});return e}function _e(t){return t==="w"?"white":"black"}function Je(t){const e=new Map;for(const o of no){const s=t.moves({square:o,verbose:!0});s.length&&e.set(s[0].from,s.map(i=>i.to))}return e}function yo(t,e){if((e==null?void 0:e.type)!=="p")return!1;const o=(e==null?void 0:e.color)==="w"?"8":"1";return t[1]===o}function fe(t){return!!t&&t instanceof Object&&!(t instanceof Array)&&!(t instanceof Function)}function ye(t){return fe(t)?Object.fromEntries(Object.entries(t).map(([e,o])=>[e,ye(o)])):t}function mt(t,e){const o={...t,...e};for(const s in o)o[s]=fe(t==null?void 0:t[s])&&fe(e==null?void 0:e[s])?mt(t[s],e[s]):ye(o[s]);return o}function bt(t,e){const o={};for(const s in e)if(fe(t==null?void 0:t[s])&&fe(e==null?void 0:e[s])){const i=bt(t[s],e[s]);Object.keys(i).length>0&&(o[s]=i)}else(t==null?void 0:t[s])!==e[s]&&(o[s]=e[s]);return o}const ko={p:"pawn",n:"knight",b:"bishop",r:"rook",q:"queen",k:"king"},So=new Map([["b1",["a3","c3"]],["g1",["f3","h3"]],["a2",["a3","a4"]],["b2",["b3","b4"]],["c2",["c3","c4"]],["d2",["d3","d4"]],["e2",["e3","e4"]],["f2",["f3","f4"]],["g2",["g3","g4"]],["h2",["h3","h4"]]]),Co="rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR w KQkq - 0 1",Eo={fen:Co,orientation:"white",turnColor:"white",coordinates:!1,autoCastle:!0,viewOnly:!1,disableContextMenu:!1,addPieceZIndex:!1,blockTouchScroll:!1,highlight:{lastMove:!0,check:!0},animation:{enabled:!0,duration:300},lastMove:void 0,movable:{free:!1,color:"white",showDests:!0,dests:So,events:{after:()=>{},afterNewPiece:void 0},rookCastle:!0},premovable:{enabled:!0,showDests:!0,castle:!0,events:{set:void 0,unset:void 0}},predroppable:{enabled:!1,events:{set:void 0,unset:void 0}},draggable:{enabled:!0,distance:3,autoDistance:!0,showGhost:!0,deleteOnDropOff:!1},selectable:{enabled:!0},events:{change:void 0,move:void 0,dropNewPiece:void 0,select:void 0,insert:void 0},drawable:{enabled:!0,visible:!0,defaultSnapToValidMove:!0,eraseOnClick:!0,shapes:[],autoShapes:[],brushes:{green:{key:"g",color:"#15781B",opacity:1,lineWidth:10},red:{key:"r",color:"#882020",opacity:1,lineWidth:10},blue:{key:"b",color:"#003088",opacity:1,lineWidth:10},yellow:{key:"y",color:"#e68f00",opacity:1,lineWidth:10},paleBlue:{key:"pb",color:"#003088",opacity:.4,lineWidth:15},paleGreen:{key:"pg",color:"#15781B",opacity:.4,lineWidth:15},paleRed:{key:"pr",color:"#882020",opacity:.4,lineWidth:15},paleGrey:{key:"pgr",color:"#4a4a4a",opacity:.35,lineWidth:15}}}},Mo=["white","black"],$e=["a","b","c","d","e","f","g","h"],Ke=["1","2","3","4","5","6","7","8"],Po=[...Ke].reverse(),Be=Array.prototype.concat(...$e.map(t=>Ke.map(e=>t+e))),$=t=>Be[8*t[0]+t[1]],k=t=>[t.charCodeAt(0)-97,t.charCodeAt(1)-49],vt=Be.map(k);function xo(t){let e;const o=()=>(e===void 0&&(e=t()),e);return o.clear=()=>{e=void 0},o}const To=()=>{let t;return{start(){t=performance.now()},cancel(){t=void 0},stop(){if(!t)return 0;const e=performance.now()-t;return t=void 0,e}}},Ve=t=>t==="white"?"black":"white",ge=(t,e)=>{const o=t[0]-e[0],s=t[1]-e[1];return o*o+s*s},qe=(t,e)=>t.role===e.role&&t.color===e.color,me=t=>(e,o)=>[(o?e[0]:7-e[0])*t.width/8,(o?7-e[1]:e[1])*t.height/8],j=(t,e)=>{t.style.transform=`translate(${e[0]}px,${e[1]}px)`},_t=(t,e,o=1)=>{t.style.transform=`translate(${e[0]}px,${e[1]}px) scale(${o})`},je=(t,e)=>{t.style.visibility=e?"visible":"hidden"},se=t=>{var e;if(t.clientX||t.clientX===0)return[t.clientX,t.clientY];if(!((e=t.targetTouches)===null||e===void 0)&&e[0])return[t.targetTouches[0].clientX,t.targetTouches[0].clientY]},wt=t=>t.buttons===2||t.button===2,Q=(t,e)=>{const o=document.createElement(t);return e&&(o.className=e),o};function yt(t,e,o){const s=k(t);return e||(s[0]=7-s[0],s[1]=7-s[1]),[o.left+o.width*s[0]/8+o.width/16,o.top+o.height*(7-s[1])/8+o.height/16]}const oe=(t,e)=>Math.abs(t-e),Ao=t=>(e,o,s,i)=>oe(e,s)<2&&(t==="white"?i===o+1||o<=1&&i===o+2&&e===s:i===o-1||o>=6&&i===o-2&&e===s),kt=(t,e,o,s)=>{const i=oe(t,o),n=oe(e,s);return i===1&&n===2||i===2&&n===1},St=(t,e,o,s)=>oe(t,o)===oe(e,s),Ct=(t,e,o,s)=>t===o||e===s,Et=(t,e,o,s)=>St(t,e,o,s)||Ct(t,e,o,s),No=(t,e,o)=>(s,i,n,r)=>oe(s,n)<2&&oe(i,r)<2||o&&i===r&&i===(t==="white"?0:7)&&(s===4&&(n===2&&e.includes(0)||n===6&&e.includes(7))||e.includes(n));function Io(t,e){const o=e==="white"?"1":"8",s=[];for(const[i,n]of t)i[1]===o&&n.color===e&&n.role==="rook"&&s.push(k(i)[0]);return s}function Mt(t,e,o){const s=t.get(e);if(!s)return[];const i=k(e),n=s.role,r=n==="pawn"?Ao(s.color):n==="knight"?kt:n==="bishop"?St:n==="rook"?Ct:n==="queen"?Et:No(s.color,Io(t,s.color),o);return vt.filter(a=>(i[0]!==a[0]||i[1]!==a[1])&&r(i[0],i[1],a[0],a[1])).map($)}function I(t,...e){t&&setTimeout(()=>t(...e),1)}function qo(t){t.orientation=Ve(t.orientation),t.animation.current=t.draggable.current=t.selected=void 0}function Lo(t,e){for(const[o,s]of e)s?t.pieces.set(o,s):t.pieces.delete(o)}function Oo(t,e){if(t.check=void 0,e===!0&&(e=t.turnColor),e)for(const[o,s]of t.pieces)s.role==="king"&&s.color===e&&(t.check=o)}function Do(t,e,o,s){J(t),t.premovable.current=[e,o],I(t.premovable.events.set,e,o,s)}function X(t){t.premovable.current&&(t.premovable.current=void 0,I(t.premovable.events.unset))}function Ro(t,e,o){X(t),t.predroppable.current={role:e,key:o},I(t.predroppable.events.set,e,o)}function J(t){const e=t.predroppable;e.current&&(e.current=void 0,I(e.events.unset))}function $o(t,e,o){if(!t.autoCastle)return!1;const s=t.pieces.get(e);if(!s||s.role!=="king")return!1;const i=k(e),n=k(o);if(i[1]!==0&&i[1]!==7||i[1]!==n[1])return!1;i[0]===4&&!t.pieces.has(o)&&(n[0]===6?o=$([7,n[1]]):n[0]===2&&(o=$([0,n[1]])));const r=t.pieces.get(o);return!r||r.color!==s.color||r.role!=="rook"?!1:(t.pieces.delete(e),t.pieces.delete(o),i[0]<n[0]?(t.pieces.set($([6,n[1]]),s),t.pieces.set($([5,n[1]]),r)):(t.pieces.set($([2,n[1]]),s),t.pieces.set($([3,n[1]]),r)),!0)}function Pt(t,e,o){const s=t.pieces.get(e),i=t.pieces.get(o);if(e===o||!s)return!1;const n=i&&i.color!==s.color?i:void 0;return o===t.selected&&K(t),I(t.events.move,e,o,n),$o(t,e,o)||(t.pieces.set(o,s),t.pieces.delete(e)),t.lastMove=[e,o],t.check=void 0,I(t.events.change),n||!0}function Fe(t,e,o,s){if(t.pieces.has(o))if(s)t.pieces.delete(o);else return!1;return I(t.events.dropNewPiece,e,o),t.pieces.set(o,e),t.lastMove=[o],t.check=void 0,I(t.events.change),t.movable.dests=void 0,t.turnColor=Ve(t.turnColor),!0}function xt(t,e,o){const s=Pt(t,e,o);return s&&(t.movable.dests=void 0,t.turnColor=Ve(t.turnColor),t.animation.current=void 0),s}function Tt(t,e,o){if(We(t,e,o)){const s=xt(t,e,o);if(s){const i=t.hold.stop();K(t);const n={premove:!1,ctrlKey:t.stats.ctrlKey,holdTime:i};return s!==!0&&(n.captured=s),I(t.movable.events.after,e,o,n),!0}}else if(Bo(t,e,o))return Do(t,e,o,{ctrlKey:t.stats.ctrlKey}),K(t),!0;return K(t),!1}function At(t,e,o,s){const i=t.pieces.get(e);i&&(Ko(t,e,o)||s)?(t.pieces.delete(e),Fe(t,i,o,s),I(t.movable.events.afterNewPiece,i.role,o,{premove:!1,predrop:!1})):i&&Vo(t,e,o)?Ro(t,i.role,o):(X(t),J(t)),t.pieces.delete(e),K(t)}function Le(t,e,o){if(I(t.events.select,e),t.selected){if(t.selected===e&&!t.draggable.enabled){K(t),t.hold.cancel();return}else if((t.selectable.enabled||o)&&t.selected!==e&&Tt(t,t.selected,e)){t.stats.dragged=!1;return}}(t.selectable.enabled||t.draggable.enabled)&&(It(t,e)||He(t,e))&&(Nt(t,e),t.hold.start())}function Nt(t,e){t.selected=e,He(t,e)?t.premovable.customDests||(t.premovable.dests=Mt(t.pieces,e,t.premovable.castle)):t.premovable.dests=void 0}function K(t){t.selected=void 0,t.premovable.dests=void 0,t.hold.cancel()}function It(t,e){const o=t.pieces.get(e);return!!o&&(t.movable.color==="both"||t.movable.color===o.color&&t.turnColor===o.color)}const We=(t,e,o)=>{var s,i;return e!==o&&It(t,e)&&(t.movable.free||!!(!((i=(s=t.movable.dests)===null||s===void 0?void 0:s.get(e))===null||i===void 0)&&i.includes(o)))};function Ko(t,e,o){const s=t.pieces.get(e);return!!s&&(e===o||!t.pieces.has(o))&&(t.movable.color==="both"||t.movable.color===s.color&&t.turnColor===s.color)}function He(t,e){const o=t.pieces.get(e);return!!o&&t.premovable.enabled&&t.movable.color===o.color&&t.turnColor!==o.color}function Bo(t,e,o){var s,i;const n=(i=(s=t.premovable.customDests)===null||s===void 0?void 0:s.get(e))!==null&&i!==void 0?i:Mt(t.pieces,e,t.premovable.castle);return e!==o&&He(t,e)&&n.includes(o)}function Vo(t,e,o){const s=t.pieces.get(e),i=t.pieces.get(o);return!!s&&(!i||i.color!==t.movable.color)&&t.predroppable.enabled&&(s.role!=="pawn"||o[1]!=="1"&&o[1]!=="8")&&t.movable.color===s.color&&t.turnColor!==s.color}function jo(t,e){const o=t.pieces.get(e);return!!o&&t.draggable.enabled&&(t.movable.color==="both"||t.movable.color===o.color&&(t.turnColor===o.color||t.premovable.enabled))}function Fo(t){const e=t.premovable.current;if(!e)return!1;const o=e[0],s=e[1];let i=!1;if(We(t,o,s)){const n=xt(t,o,s);if(n){const r={premove:!0};n!==!0&&(r.captured=n),I(t.movable.events.after,o,s,r),i=!0}}return X(t),i}function Wo(t,e){const o=t.predroppable.current;let s=!1;if(!o)return!1;if(e(o)){const i={role:o.role,color:t.movable.color};Fe(t,i,o.key)&&(I(t.movable.events.afterNewPiece,o.role,o.key,{premove:!1,predrop:!0}),s=!0)}return J(t),s}function Qe(t){X(t),J(t),K(t)}function et(t){t.movable.color=t.movable.dests=t.animation.current=void 0,Qe(t)}function ie(t,e,o){let s=Math.floor(8*(t[0]-o.left)/o.width);e||(s=7-s);let i=7-Math.floor(8*(t[1]-o.top)/o.height);return e||(i=7-i),s>=0&&s<8&&i>=0&&i<8?$([s,i]):void 0}function Ho(t,e,o,s){const i=k(t),n=vt.filter(l=>Et(i[0],i[1],l[0],l[1])||kt(i[0],i[1],l[0],l[1])),r=n.map(l=>yt($(l),o,s)).map(l=>ge(e,l)),[,a]=r.reduce((l,c,p)=>l[0]<c?l:[c,p],[r[0],0]);return $(n[a])}const q=t=>t.orientation==="white",qt="rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR",Qo={p:"pawn",r:"rook",n:"knight",b:"bishop",q:"queen",k:"king"},Uo={pawn:"p",rook:"r",knight:"n",bishop:"b",queen:"q",king:"k"};function Lt(t){t==="start"&&(t=qt);const e=new Map;let o=7,s=0;for(const i of t)switch(i){case" ":case"[":return e;case"/":if(--o,o<0)return e;s=0;break;case"~":{const n=e.get($([s-1,o]));n&&(n.promoted=!0);break}default:{const n=i.charCodeAt(0);if(n<57)s+=n-48;else{const r=i.toLowerCase();e.set($([s,o]),{role:Qo[r],color:i===r?"black":"white"}),++s}}}return e}function Go(t){return Po.map(e=>$e.map(o=>{const s=t.get(o+e);if(s){let i=Uo[s.role];return s.color==="white"&&(i=i.toUpperCase()),s.promoted&&(i+="~"),i}else return"1"}).join("")).join("/").replace(/1{2,}/g,e=>e.length.toString())}function Ot(t,e){e.animation&&(Ue(t.animation,e.animation),(t.animation.duration||0)<70&&(t.animation.enabled=!1))}function Dt(t,e){var o,s,i;if(!((o=e.movable)===null||o===void 0)&&o.dests&&(t.movable.dests=void 0),!((s=e.drawable)===null||s===void 0)&&s.autoShapes&&(t.drawable.autoShapes=[]),Ue(t,e),e.fen&&(t.pieces=Lt(e.fen),t.drawable.shapes=((i=e.drawable)===null||i===void 0?void 0:i.shapes)||[]),"check"in e&&Oo(t,e.check||!1),"lastMove"in e&&!e.lastMove?t.lastMove=void 0:e.lastMove&&(t.lastMove=e.lastMove),t.selected&&Nt(t,t.selected),Ot(t,e),!t.movable.rookCastle&&t.movable.dests){const n=t.movable.color==="white"?"1":"8",r="e"+n,a=t.movable.dests.get(r),l=t.pieces.get(r);if(!a||!l||l.role!=="king")return;t.movable.dests.set(r,a.filter(c=>!(c==="a"+n&&a.includes("c"+n))&&!(c==="h"+n&&a.includes("g"+n))))}}function Ue(t,e){for(const o in e)Object.prototype.hasOwnProperty.call(e,o)&&(Object.prototype.hasOwnProperty.call(t,o)&&tt(t[o])&&tt(e[o])?Ue(t[o],e[o]):t[o]=e[o])}function tt(t){if(typeof t!="object"||t===null)return!1;const e=Object.getPrototypeOf(t);return e===Object.prototype||e===null}const ee=(t,e)=>e.animation.enabled?Zo(t,e):z(t,e);function z(t,e){const o=t(e);return e.dom.redraw(),o}const xe=(t,e)=>({key:t,pos:k(t),piece:e}),zo=(t,e)=>e.sort((o,s)=>ge(t.pos,o.pos)-ge(t.pos,s.pos))[0];function Yo(t,e){const o=new Map,s=[],i=new Map,n=[],r=[],a=new Map;let l,c,p;for(const[u,h]of t)a.set(u,xe(u,h));for(const u of Be)l=e.pieces.get(u),c=a.get(u),l?c?qe(l,c.piece)||(n.push(c),r.push(xe(u,l))):r.push(xe(u,l)):c&&n.push(c);for(const u of r)c=zo(u,n.filter(h=>qe(u.piece,h.piece))),c&&(p=[c.pos[0]-u.pos[0],c.pos[1]-u.pos[1]],o.set(u.key,p.concat(p)),s.push(c.key));for(const u of n)s.includes(u.key)||i.set(u.key,u.piece);return{anims:o,fadings:i}}function Rt(t,e){const o=t.animation.current;if(o===void 0){t.dom.destroyed||t.dom.redrawNow();return}const s=1-(e-o.start)*o.frequency;if(s<=0)t.animation.current=void 0,t.dom.redrawNow();else{const i=Xo(s);for(const n of o.plan.anims.values())n[2]=n[0]*i,n[3]=n[1]*i;t.dom.redrawNow(!0),requestAnimationFrame((n=performance.now())=>Rt(t,n))}}function Zo(t,e){const o=new Map(e.pieces),s=t(e),i=Yo(o,e);if(i.anims.size||i.fadings.size){const n=e.animation.current&&e.animation.current.start;e.animation.current={start:performance.now(),frequency:1/e.animation.duration,plan:i},n||Rt(e,performance.now())}else e.dom.redraw();return s}const Xo=t=>t<.5?4*t*t*t:(t-1)*(2*t-2)*(2*t-2)+1,Jo=["green","red","blue","yellow"];function es(t,e){if(e.touches&&e.touches.length>1)return;e.stopPropagation(),e.preventDefault(),e.ctrlKey?K(t):Qe(t);const o=se(e),s=ie(o,q(t),t.dom.bounds());s&&(t.drawable.current={orig:s,pos:o,brush:is(e),snapToValidMove:t.drawable.defaultSnapToValidMove},$t(t))}function $t(t){requestAnimationFrame(()=>{const e=t.drawable.current;if(e){const o=ie(e.pos,q(t),t.dom.bounds());o||(e.snapToValidMove=!1);const s=e.snapToValidMove?Ho(e.orig,e.pos,q(t),t.dom.bounds()):o;s!==e.mouseSq&&(e.mouseSq=s,e.dest=s!==e.orig?s:void 0,t.dom.redrawNow()),$t(t)}})}function ts(t,e){t.drawable.current&&(t.drawable.current.pos=se(e))}function os(t){const e=t.drawable.current;e&&(e.mouseSq&&ns(t.drawable,e),Kt(t))}function Kt(t){t.drawable.current&&(t.drawable.current=void 0,t.dom.redraw())}function ss(t){t.drawable.shapes.length&&(t.drawable.shapes=[],t.dom.redraw(),Bt(t.drawable))}function is(t){var e;const o=(t.shiftKey||t.ctrlKey)&&wt(t),s=t.altKey||t.metaKey||((e=t.getModifierState)===null||e===void 0?void 0:e.call(t,"AltGraph"));return Jo[(o?1:0)+(s?2:0)]}function ns(t,e){const o=i=>i.orig===e.orig&&i.dest===e.dest,s=t.shapes.find(o);s&&(t.shapes=t.shapes.filter(i=>!o(i))),(!s||s.brush!==e.brush)&&t.shapes.push({orig:e.orig,dest:e.dest,brush:e.brush}),Bt(t)}function Bt(t){t.onChange&&t.onChange(t.shapes)}function rs(t,e){if(!(t.trustAllEvents||e.isTrusted)||e.button!==void 0&&e.button!==0||e.touches&&e.touches.length>1)return;const o=t.dom.bounds(),s=se(e),i=ie(s,q(t),o);if(!i)return;const n=t.pieces.get(i),r=t.selected;if(!r&&t.drawable.enabled&&(t.drawable.eraseOnClick||!n||n.color!==t.turnColor)&&ss(t),e.cancelable!==!1&&(!e.touches||t.blockTouchScroll||n||r||as(t,s)))e.preventDefault();else if(e.touches)return;const a=!!t.premovable.current,l=!!t.predroppable.current;t.stats.ctrlKey=e.ctrlKey,t.selected&&We(t,t.selected,i)?ee(u=>Le(u,i),t):Le(t,i);const c=t.selected===i,p=jt(t,i);if(n&&p&&c&&jo(t,i)){t.draggable.current={orig:i,piece:n,origPos:s,pos:s,started:t.draggable.autoDistance&&t.stats.dragged,element:p,previouslySelected:r,originTarget:e.target,keyHasChanged:!1},p.cgDragging=!0,p.classList.add("dragging");const u=t.dom.elements.ghost;u&&(u.className=`ghost ${n.color} ${n.role}`,j(u,me(o)(k(i),q(t))),je(u,!0)),Ge(t)}else a&&X(t),l&&J(t);t.dom.redraw()}function as(t,e){const o=q(t),s=t.dom.bounds(),i=Math.pow(s.width/8,2);for(const n of t.pieces.keys()){const r=yt(n,o,s);if(ge(r,e)<=i)return!0}return!1}function ls(t,e,o,s){const i="a0";t.pieces.set(i,e),t.dom.redraw();const n=se(o);t.draggable.current={orig:i,piece:e,origPos:n,pos:n,started:!0,element:()=>jt(t,i),originTarget:o.target,newPiece:!0,force:!!s,keyHasChanged:!1},Ge(t)}function Ge(t){requestAnimationFrame(()=>{var e;const o=t.draggable.current;if(!o)return;!((e=t.animation.current)===null||e===void 0)&&e.plan.anims.has(o.orig)&&(t.animation.current=void 0);const s=t.pieces.get(o.orig);if(!s||!qe(s,o.piece))ke(t);else if(!o.started&&ge(o.pos,o.origPos)>=Math.pow(t.draggable.distance,2)&&(o.started=!0),o.started){if(typeof o.element=="function"){const n=o.element();if(!n)return;n.cgDragging=!0,n.classList.add("dragging"),o.element=n}const i=t.dom.bounds();j(o.element,[o.pos[0]-i.left-i.width/16,o.pos[1]-i.top-i.height/16]),o.keyHasChanged||(o.keyHasChanged=o.orig!==ie(o.pos,q(t),i))}Ge(t)})}function cs(t,e){t.draggable.current&&(!e.touches||e.touches.length<2)&&(t.draggable.current.pos=se(e))}function hs(t,e){const o=t.draggable.current;if(!o)return;if(e.type==="touchend"&&e.cancelable!==!1&&e.preventDefault(),e.type==="touchend"&&o.originTarget!==e.target&&!o.newPiece){t.draggable.current=void 0;return}X(t),J(t);const s=se(e)||o.pos,i=ie(s,q(t),t.dom.bounds());i&&o.started&&o.orig!==i?o.newPiece?At(t,o.orig,i,o.force):(t.stats.ctrlKey=e.ctrlKey,Tt(t,o.orig,i)&&(t.stats.dragged=!0)):o.newPiece?t.pieces.delete(o.orig):t.draggable.deleteOnDropOff&&!i&&(t.pieces.delete(o.orig),I(t.events.change)),(o.orig===o.previouslySelected||o.keyHasChanged)&&(o.orig===i||!i)?K(t):t.selectable.enabled||K(t),Vt(t),t.draggable.current=void 0,t.dom.redraw()}function ke(t){const e=t.draggable.current;e&&(e.newPiece&&t.pieces.delete(e.orig),t.draggable.current=void 0,K(t),Vt(t),t.dom.redraw())}function Vt(t){const e=t.dom.elements;e.ghost&&je(e.ghost,!1)}function jt(t,e){let o=t.dom.elements.board.firstChild;for(;o;){if(o.cgKey===e&&o.tagName==="PIECE")return o;o=o.nextSibling}}function ds(t,e){t.exploding={stage:1,keys:e},t.dom.redraw(),setTimeout(()=>{ot(t,2),setTimeout(()=>ot(t,void 0),120)},120)}function ot(t,e){t.exploding&&(e?t.exploding.stage=e:t.exploding=void 0,t.dom.redraw())}function us(t,e){function o(){qo(t),e()}return{set(s){s.orientation&&s.orientation!==t.orientation&&o(),Ot(t,s),(s.fen?ee:z)(i=>Dt(i,s),t)},state:t,getFen:()=>Go(t.pieces),toggleOrientation:o,setPieces(s){ee(i=>Lo(i,s),t)},selectSquare(s,i){s?ee(n=>Le(n,s,i),t):t.selected&&(K(t),t.dom.redraw())},move(s,i){ee(n=>Pt(n,s,i),t)},newPiece(s,i){ee(n=>Fe(n,s,i),t)},playPremove(){if(t.premovable.current){if(ee(Fo,t))return!0;t.dom.redraw()}return!1},playPredrop(s){if(t.predroppable.current){const i=Wo(t,s);return t.dom.redraw(),i}return!1},cancelPremove(){z(X,t)},cancelPredrop(){z(J,t)},cancelMove(){z(s=>{Qe(s),ke(s)},t)},stop(){z(s=>{et(s),ke(s)},t)},explode(s){ds(t,s)},setAutoShapes(s){z(i=>i.drawable.autoShapes=s,t)},setShapes(s){z(i=>i.drawable.shapes=s,t)},getKeyAtDomPos(s){return ie(s,q(t),t.dom.bounds())},redrawAll:e,dragNewPiece(s,i,n){ls(t,s,i,n)},destroy(){et(t),t.dom.unbind&&t.dom.unbind(),t.dom.destroyed=!0}}}function ps(){return{pieces:Lt(qt),orientation:"white",turnColor:"white",coordinates:!0,ranksPosition:"right",autoCastle:!0,viewOnly:!1,disableContextMenu:!1,addPieceZIndex:!1,blockTouchScroll:!1,pieceKey:!1,trustAllEvents:!1,highlight:{lastMove:!0,check:!0},animation:{enabled:!0,duration:200},movable:{free:!0,color:"both",showDests:!0,events:{},rookCastle:!0},premovable:{enabled:!0,showDests:!0,castle:!0,events:{}},predroppable:{enabled:!1,events:{}},draggable:{enabled:!0,distance:3,autoDistance:!0,showGhost:!0,deleteOnDropOff:!1},dropmode:{active:!1},selectable:{enabled:!0},stats:{dragged:!("ontouchstart"in window)},events:{},drawable:{enabled:!0,visible:!0,defaultSnapToValidMove:!0,eraseOnClick:!0,shapes:[],autoShapes:[],brushes:{green:{key:"g",color:"#15781B",opacity:1,lineWidth:10},red:{key:"r",color:"#882020",opacity:1,lineWidth:10},blue:{key:"b",color:"#003088",opacity:1,lineWidth:10},yellow:{key:"y",color:"#e68f00",opacity:1,lineWidth:10},paleBlue:{key:"pb",color:"#003088",opacity:.4,lineWidth:15},paleGreen:{key:"pg",color:"#15781B",opacity:.4,lineWidth:15},paleRed:{key:"pr",color:"#882020",opacity:.4,lineWidth:15},paleGrey:{key:"pgr",color:"#4a4a4a",opacity:.35,lineWidth:15},purple:{key:"purp",color:"#68217a",opacity:.65,lineWidth:10},pink:{key:"pink",color:"#ee2080",opacity:.5,lineWidth:10},hilite:{key:"hilite",color:"#fff",opacity:1,lineWidth:1}},prevSvgHash:""},hold:To()}}function fs(){const t=E("defs"),e=A(E("filter"),{id:"cg-filter-blur"});return e.appendChild(A(E("feGaussianBlur"),{stdDeviation:"0.022"})),t.appendChild(e),t}function gs(t,e,o){var s;const i=t.drawable,n=i.current,r=n&&n.mouseSq?n:void 0,a=new Map,l=t.dom.bounds(),c=i.autoShapes.filter(g=>!g.piece);for(const g of i.shapes.concat(c).concat(r?[r]:[])){if(!g.dest)continue;const d=(s=a.get(g.dest))!==null&&s!==void 0?s:new Set,f=Ce(Se(k(g.orig),t.orientation),l),_=Ce(Se(k(g.dest),t.orientation),l);d.add(De(f,_)),a.set(g.dest,d)}const p=i.shapes.concat(c).map(g=>({shape:g,current:!1,hash:st(g,Oe(g.dest,a),!1,l)}));r&&p.push({shape:r,current:!0,hash:st(r,Oe(r.dest,a),!0,l)});const u=p.map(g=>g.hash).join(";");if(u===t.drawable.prevSvgHash)return;t.drawable.prevSvgHash=u;const h=e.querySelector("defs");ms(i,p,h),bs(p,e.querySelector("g"),o.querySelector("g"),g=>ws(t,g,i.brushes,a,l))}function ms(t,e,o){var s;const i=new Map;let n;for(const l of e.filter(c=>c.shape.dest&&c.shape.brush))n=Ft(t.brushes[l.shape.brush],l.shape.modifiers),!((s=l.shape.modifiers)===null||s===void 0)&&s.hilite&&i.set("hilite",t.brushes.hilite),i.set(n.key,n);const r=new Set;let a=o.firstElementChild;for(;a;)r.add(a.getAttribute("cgKey")),a=a.nextElementSibling;for(const[l,c]of i.entries())r.has(l)||o.appendChild(Ss(c))}function bs(t,e,o,s){const i=new Map;for(const n of t)i.set(n.hash,!1);for(const n of[e,o]){const r=[];let a=n.firstElementChild,l;for(;a;)l=a.getAttribute("cgHash"),i.has(l)?i.set(l,!0):r.push(a),a=a.nextElementSibling;for(const c of r)n.removeChild(c)}for(const n of t.filter(r=>!i.get(r.hash)))for(const r of s(n))r.isCustom?o.appendChild(r.el):e.appendChild(r.el)}function st({orig:t,dest:e,brush:o,piece:s,modifiers:i,customSvg:n,label:r},a,l,c){var p,u;return[c.width,c.height,l,t,e,o,a&&"-",s&&vs(s),i&&_s(i),n&&`custom-${it(n.html)},${(u=(p=n.center)===null||p===void 0?void 0:p[0])!==null&&u!==void 0?u:"o"}`,r&&`label-${it(r.text)}`].filter(h=>h).join(",")}function vs(t){return[t.color,t.role,t.scale].filter(e=>e).join(",")}function _s(t){return[t.lineWidth,t.hilite&&"*"].filter(e=>e).join(",")}function it(t){let e=0;for(let o=0;o<t.length;o++)e=(e<<5)-e+t.charCodeAt(o)>>>0;return e.toString()}function ws(t,{shape:e,current:o,hash:s},i,n,r){var a,l;const c=Ce(Se(k(e.orig),t.orientation),r),p=e.dest?Ce(Se(k(e.dest),t.orientation),r):c,u=e.brush&&Ft(i[e.brush],e.modifiers),h=n.get(e.dest),g=[];if(u){const d=A(E("g"),{cgHash:s});g.push({el:d}),c[0]!==p[0]||c[1]!==p[1]?d.appendChild(ks(e,u,c,p,o,Oe(e.dest,n))):d.appendChild(ys(i[e.brush],c,o,r))}if(e.label){const d=e.label;(a=d.fill)!==null&&a!==void 0||(d.fill=e.brush&&i[e.brush].color);const f=e.brush?void 0:"tr";g.push({el:Cs(d,s,c,p,h,f),isCustom:!0})}if(e.customSvg){const d=(l=e.customSvg.center)!==null&&l!==void 0?l:"orig",[f,_]=d==="label"?Ht(c,p,h).map(m=>m-.5):d==="dest"?p:c,y=A(E("g"),{transform:`translate(${f},${_})`,cgHash:s});y.innerHTML=`<svg width="1" height="1" viewBox="0 0 100 100">${e.customSvg.html}</svg>`,g.push({el:y,isCustom:!0})}return g}function ys(t,e,o,s){const i=Es(),n=(s.width+s.height)/(4*Math.max(s.width,s.height));return A(E("circle"),{stroke:t.color,"stroke-width":i[o?0:1],fill:"none",opacity:Wt(t,o),cx:e[0],cy:e[1],r:n-i[1]/2})}function ks(t,e,o,s,i,n){var r;function a(p){var u;const h=Ps(n&&!i),g=s[0]-o[0],d=s[1]-o[1],f=Math.atan2(d,g),_=Math.cos(f)*h,y=Math.sin(f)*h;return A(E("line"),{stroke:p?"white":e.color,"stroke-width":Ms(e,i)+(p?.04:0),"stroke-linecap":"round","marker-end":`url(#arrowhead-${p?"hilite":e.key})`,opacity:!((u=t.modifiers)===null||u===void 0)&&u.hilite?1:Wt(e,i),x1:o[0],y1:o[1],x2:s[0]-_,y2:s[1]-y})}if(!(!((r=t.modifiers)===null||r===void 0)&&r.hilite))return a(!1);const l=E("g"),c=A(E("g"),{filter:"url(#cg-filter-blur)"});return c.appendChild(xs(o,s)),c.appendChild(a(!0)),l.appendChild(c),l.appendChild(a(!1)),l}function Ss(t){const e=A(E("marker"),{id:"arrowhead-"+t.key,orient:"auto",overflow:"visible",markerWidth:4,markerHeight:4,refX:t.key==="hilite"?1.86:2.05,refY:2});return e.appendChild(A(E("path"),{d:"M0,0 V4 L3,2 Z",fill:t.color})),e.setAttribute("cgKey",t.key),e}function Cs(t,e,o,s,i,n){var r;const a=.4*.75**t.text.length,l=Ht(o,s,i),c=n==="tr"?.4:0,p=A(E("g"),{transform:`translate(${l[0]+c},${l[1]-c})`,cgHash:e});p.appendChild(A(E("circle"),{r:.4/2,"fill-opacity":n?1:.8,"stroke-opacity":n?1:.7,"stroke-width":.03,fill:(r=t.fill)!==null&&r!==void 0?r:"#666",stroke:"white"}));const u=A(E("text"),{"font-size":a,"font-family":"Noto Sans","text-anchor":"middle",fill:"white",y:.13*.75**t.text.length});return u.innerHTML=t.text,p.appendChild(u),p}function Se(t,e){return e==="white"?t:[7-t[0],7-t[1]]}function Oe(t,e){return(t&&e.has(t)&&e.get(t).size>1)===!0}function E(t){return document.createElementNS("http://www.w3.org/2000/svg",t)}function A(t,e){for(const o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.setAttribute(o,e[o]);return t}function Ft(t,e){return e?{color:t.color,opacity:Math.round(t.opacity*10)/10,lineWidth:Math.round(e.lineWidth||t.lineWidth),key:[t.key,e.lineWidth].filter(o=>o).join("")}:t}function Es(){return[3/64,4/64]}function Ms(t,e){return(t.lineWidth||10)*(e?.85:1)/64}function Wt(t,e){return(t.opacity||1)*(e?.9:1)}function Ps(t){return(t?20:10)/64}function Ce(t,e){const o=Math.min(1,e.width/e.height),s=Math.min(1,e.height/e.width);return[(t[0]-3.5)*o,(3.5-t[1])*s]}function xs(t,e){const o={from:[Math.floor(Math.min(t[0],e[0])),Math.floor(Math.min(t[1],e[1]))],to:[Math.ceil(Math.max(t[0],e[0])),Math.ceil(Math.max(t[1],e[1]))]};return A(E("rect"),{x:o.from[0],y:o.from[1],width:o.to[0]-o.from[0],height:o.to[1]-o.from[1],fill:"none",stroke:"none"})}function De(t,e,o=!0){const s=Math.atan2(e[1]-t[1],e[0]-t[0])+Math.PI;return o?(Math.round(s*8/Math.PI)+16)%16:s}function Ts(t,e){return Math.sqrt([t[0]-e[0],t[1]-e[1]].reduce((o,s)=>o+s*s,0))}function Ht(t,e,o){let s=Ts(t,e);const i=De(t,e,!1);if(o&&(s-=33/64,o.size>1)){s-=10/64;const n=De(t,e);(o.has((n+1)%16)||o.has((n+15)%16))&&n&1&&(s-=.4)}return[t[0]-Math.cos(i)*s,t[1]-Math.sin(i)*s].map(n=>n+.5)}function As(t,e){t.innerHTML="",t.classList.add("cg-wrap");for(const l of Mo)t.classList.toggle("orientation-"+l,e.orientation===l);t.classList.toggle("manipulable",!e.viewOnly);const o=Q("cg-container");t.appendChild(o);const s=Q("cg-board");o.appendChild(s);let i,n,r;if(e.drawable.visible&&(i=A(E("svg"),{class:"cg-shapes",viewBox:"-4 -4 8 8",preserveAspectRatio:"xMidYMid slice"}),i.appendChild(fs()),i.appendChild(E("g")),n=A(E("svg"),{class:"cg-custom-svgs",viewBox:"-3.5 -3.5 8 8",preserveAspectRatio:"xMidYMid slice"}),n.appendChild(E("g")),r=Q("cg-auto-pieces"),o.appendChild(i),o.appendChild(n),o.appendChild(r)),e.coordinates){const l=e.orientation==="black"?" black":"",c=e.ranksPosition==="left"?" left":"";o.appendChild(nt(Ke,"ranks"+l+c)),o.appendChild(nt($e,"files"+l))}let a;return e.draggable.enabled&&e.draggable.showGhost&&(a=Q("piece","ghost"),je(a,!1),o.appendChild(a)),{board:s,container:o,wrap:t,ghost:a,svg:i,customSvg:n,autoPieces:r}}function nt(t,e){const o=Q("coords",e);let s;for(const i of t)s=Q("coord"),s.textContent=i,o.appendChild(s);return o}function Ns(t,e){if(!t.dropmode.active)return;X(t),J(t);const o=t.dropmode.piece;if(o){t.pieces.set("a0",o);const s=se(e),i=s&&ie(s,q(t),t.dom.bounds());i&&At(t,"a0",i)}t.dom.redraw()}function Is(t,e){const o=t.dom.elements.board;if("ResizeObserver"in window&&new ResizeObserver(e).observe(t.dom.elements.wrap),(t.disableContextMenu||t.drawable.enabled)&&o.addEventListener("contextmenu",i=>i.preventDefault()),t.viewOnly)return;const s=Ls(t);o.addEventListener("touchstart",s,{passive:!1}),o.addEventListener("mousedown",s,{passive:!1})}function qs(t,e){const o=[];if("ResizeObserver"in window||o.push(ce(document.body,"chessground.resize",e)),!t.viewOnly){const s=rt(t,cs,ts),i=rt(t,hs,os);for(const r of["touchmove","mousemove"])o.push(ce(document,r,s));for(const r of["touchend","mouseup"])o.push(ce(document,r,i));const n=()=>t.dom.bounds.clear();o.push(ce(document,"scroll",n,{capture:!0,passive:!0})),o.push(ce(window,"resize",n,{passive:!0}))}return()=>o.forEach(s=>s())}function ce(t,e,o,s){return t.addEventListener(e,o,s),()=>t.removeEventListener(e,o,s)}const Ls=t=>e=>{t.draggable.current?ke(t):t.drawable.current?Kt(t):e.shiftKey||wt(e)?t.drawable.enabled&&es(t,e):t.viewOnly||(t.dropmode.active?Ns(t,e):rs(t,e))},rt=(t,e,o)=>s=>{t.drawable.current?t.drawable.enabled&&o(t,s):t.viewOnly||e(t,s)};function Os(t){const e=q(t),o=me(t.dom.bounds()),s=t.dom.elements.board,i=t.pieces,n=t.animation.current,r=n?n.plan.anims:new Map,a=n?n.plan.fadings:new Map,l=t.draggable.current,c=Rs(t),p=new Set,u=new Set,h=new Map,g=new Map;let d,f,_,y,m,S,D,N,ne,W;for(f=s.firstChild;f;){if(d=f.cgKey,Qt(f))if(_=i.get(d),m=r.get(d),S=a.get(d),y=f.cgPiece,f.cgDragging&&(!l||l.orig!==d)&&(f.classList.remove("dragging"),j(f,o(k(d),e)),f.cgDragging=!1),!S&&f.cgFading&&(f.cgFading=!1,f.classList.remove("fading")),_){if(m&&f.cgAnimating&&y===he(_)){const w=k(d);w[0]+=m[2],w[1]+=m[3],f.classList.add("anim"),j(f,o(w,e))}else f.cgAnimating&&(f.cgAnimating=!1,f.classList.remove("anim"),j(f,o(k(d),e)),t.addPieceZIndex&&(f.style.zIndex=Te(k(d),e)));y===he(_)&&(!S||!f.cgFading)?p.add(d):S&&y===he(S)?(f.classList.add("fading"),f.cgFading=!0):Ae(h,y,f)}else Ae(h,y,f);else if(Ut(f)){const w=f.className;c.get(d)===w?u.add(d):Ae(g,w,f)}f=f.nextSibling}for(const[w,ae]of c)if(!u.has(w)){ne=g.get(ae),W=ne&&ne.pop();const B=o(k(w),e);if(W)W.cgKey=w,j(W,B);else{const V=Q("square",ae);V.cgKey=w,j(V,B),s.insertBefore(V,s.firstChild)}}for(const[w,ae]of i)if(m=r.get(w),!p.has(w))if(D=h.get(he(ae)),N=D&&D.pop(),N){N.cgKey=w,N.cgFading&&(N.classList.remove("fading"),N.cgFading=!1);const B=k(w);t.addPieceZIndex&&(N.style.zIndex=Te(B,e)),m&&(N.cgAnimating=!0,N.classList.add("anim"),B[0]+=m[2],B[1]+=m[3]),j(N,o(B,e))}else{const B=he(ae),V=Q("piece",B),be=k(w);V.cgPiece=B,V.cgKey=w,m&&(V.cgAnimating=!0,be[0]+=m[2],be[1]+=m[3]),j(V,o(be,e)),t.addPieceZIndex&&(V.style.zIndex=Te(be,e)),s.appendChild(V)}for(const w of h.values())lt(t,w);for(const w of g.values())lt(t,w)}function Ds(t){const e=q(t),o=me(t.dom.bounds());let s=t.dom.elements.board.firstChild;for(;s;)(Qt(s)&&!s.cgAnimating||Ut(s))&&j(s,o(k(s.cgKey),e)),s=s.nextSibling}function at(t){var e,o;const s=t.dom.elements.wrap.getBoundingClientRect(),i=t.dom.elements.container,n=s.height/s.width,r=Math.floor(s.width*window.devicePixelRatio/8)*8/window.devicePixelRatio,a=r*n;i.style.width=r+"px",i.style.height=a+"px",t.dom.bounds.clear(),(e=t.addDimensionsCssVarsTo)===null||e===void 0||e.style.setProperty("--cg-width",r+"px"),(o=t.addDimensionsCssVarsTo)===null||o===void 0||o.style.setProperty("--cg-height",a+"px")}const Qt=t=>t.tagName==="PIECE",Ut=t=>t.tagName==="SQUARE";function lt(t,e){for(const o of e)t.dom.elements.board.removeChild(o)}function Te(t,e){const o=t[1];return`${e?10-o:3+o}`}const he=t=>`${t.color} ${t.role}`;function Rs(t){var e,o,s;const i=new Map;if(t.lastMove&&t.highlight.lastMove)for(const a of t.lastMove)H(i,a,"last-move");if(t.check&&t.highlight.check&&H(i,t.check,"check"),t.selected&&(H(i,t.selected,"selected"),t.movable.showDests)){const a=(e=t.movable.dests)===null||e===void 0?void 0:e.get(t.selected);if(a)for(const c of a)H(i,c,"move-dest"+(t.pieces.has(c)?" oc":""));const l=(s=(o=t.premovable.customDests)===null||o===void 0?void 0:o.get(t.selected))!==null&&s!==void 0?s:t.premovable.dests;if(l)for(const c of l)H(i,c,"premove-dest"+(t.pieces.has(c)?" oc":""))}const n=t.premovable.current;if(n)for(const a of n)H(i,a,"current-premove");else t.predroppable.current&&H(i,t.predroppable.current.key,"current-premove");const r=t.exploding;if(r)for(const a of r.keys)H(i,a,"exploding"+r.stage);return t.highlight.custom&&t.highlight.custom.forEach((a,l)=>{H(i,l,a)}),i}function H(t,e,o){const s=t.get(e);s?t.set(e,`${s} ${o}`):t.set(e,o)}function Ae(t,e,o){const s=t.get(e);s?s.push(o):t.set(e,[o])}function $s(t,e,o){const s=new Map,i=[];for(const a of t)s.set(a.hash,!1);let n=e.firstElementChild,r;for(;n;)r=n.getAttribute("cgHash"),s.has(r)?s.set(r,!0):i.push(n),n=n.nextElementSibling;for(const a of i)e.removeChild(a);for(const a of t)s.get(a.hash)||e.appendChild(o(a))}function Ks(t,e){const o=t.drawable.autoShapes.filter(s=>s.piece).map(s=>({shape:s,hash:js(s),current:!1}));$s(o,e,s=>Vs(t,s,t.dom.bounds()))}function Bs(t){var e;const o=q(t),s=me(t.dom.bounds());let i=(e=t.dom.elements.autoPieces)===null||e===void 0?void 0:e.firstChild;for(;i;)_t(i,s(k(i.cgKey),o),i.cgScale),i=i.nextSibling}function Vs(t,{shape:e,hash:o},s){var i,n,r;const a=e.orig,l=(i=e.piece)===null||i===void 0?void 0:i.role,c=(n=e.piece)===null||n===void 0?void 0:n.color,p=(r=e.piece)===null||r===void 0?void 0:r.scale,u=Q("piece",`${l} ${c}`);return u.setAttribute("cgHash",o),u.cgKey=a,u.cgScale=p,_t(u,me(s)(k(a),q(t)),p),u}const js=t=>{var e,o,s;return[t.orig,(e=t.piece)===null||e===void 0?void 0:e.role,(o=t.piece)===null||o===void 0?void 0:o.color,(s=t.piece)===null||s===void 0?void 0:s.scale].join(",")};function Fs(t,e){const o=ps();Dt(o,e||{});function s(){const i="dom"in o?o.dom.unbind:void 0,n=As(t,o),r=xo(()=>n.board.getBoundingClientRect()),a=p=>{Os(c),n.autoPieces&&Ks(c,n.autoPieces),!p&&n.svg&&gs(c,n.svg,n.customSvg)},l=()=>{at(c),Ds(c),n.autoPieces&&Bs(c)},c=o;return c.dom={elements:n,bounds:r,redraw:Ws(a),redrawNow:a,unbind:i},c.drawable.prevSvgHash="",at(c),a(!1),Is(c,l),i||(c.dom.unbind=qs(c,l)),c.events.insert&&c.events.insert(n),c}return us(s(),s)}function Ws(t){let e=!1;return()=>{e||(e=!0,requestAnimationFrame(()=>{t(),e=!1}))}}class Gt{constructor(e,o,s,i){x(this,"game");x(this,"board");x(this,"boardState");x(this,"props");x(this,"emit");this.boardState=o,this.props=s,this.emit=i,this.game=new _o,this.board=Fs(e),this.resetBoard()}updateGameState({updateFen:e=!0}={}){this.boardState.historyViewerState.isEnabled||(e&&this.board.set({fen:this.game.fen()}),this.board.state.turnColor=this.getTurnColor(),this.board.state.movable.free?(this.board.state.movable.color="both",this.board.state.movable.dests=new Map):(this.board.state.movable.color=this.props.playerColor||this.board.state.turnColor,this.board.state.movable.dests=Je(this.game)),this.displayInCheck(this.game.inCheck(),this.board.state.turnColor),this.boardState.showThreats&&this.drawMoves()),this.emitEvents()}displayInCheck(e,o){if(e){for(const[s,i]of this.board.state.pieces)if(i.role==="king"&&i.color===o){this.board.state.check=s;return}}else this.board.state.check=void 0}emitEvents(){this.game.inCheck()&&this.emit(this.game.isCheckmate()?"checkmate":"check",this.board.state.turnColor),this.game.isDraw()&&this.emit("draw"),this.game.isStalemate()&&this.emit("stalemate")}async changeTurn(e,o,s){let i;yo(o,this.game.get(e))&&(i=await new Promise(n=>{this.boardState.promotionDialogState={isEnabled:!0,color:this.getTurnColor(),callback:n}})),this.move({from:e,to:o,promotion:i})}resetBoard(){this.setConfig(this.props.boardConfig,!0)}undoLastMove(){const e=this.game.undo();if(e!=null&&(this.boardState.historyViewerState.isEnabled&&this.boardState.historyViewerState.plyViewing===this.getCurrentPlyNumber()&&this.stopViewingHistory(),!this.boardState.historyViewerState.isEnabled)){this.board.set({fen:e.before}),this.updateGameState({updateFen:!1});const o=this.getLastMove();this.board.state.lastMove=o?[o==null?void 0:o.from,o==null?void 0:o.to]:void 0}}getMaterialCount(){const e=this.board.state.pieces,o={pawn:1,knight:3,bishop:3,rook:5,queen:9,king:0},s={materialWhite:0,materialBlack:0,materialDiff:0};for(const i of e)i[1].color==="white"?s.materialWhite+=o[i[1].role]:s.materialBlack+=o[i[1].role];return s.materialDiff=s.materialWhite-s.materialBlack,s}getCapturedPieces(){const e={white:[],black:[]};for(const{color:o,captured:s}of this.getHistory(!0))s&&e[_e(o)].push(s);return e}toggleOrientation(){this.board.toggleOrientation()}drawMoves(){this.boardState.showThreats=!0,this.board.setShapes(wo(this.game.moves({verbose:!0})))}hideMoves(){this.boardState.showThreats=!1,this.board.setShapes([])}drawMove(e,o,s){this.board.setShapes([{orig:e,dest:o,brush:s}])}toggleMoves(){this.boardState.showThreats?this.hideMoves():this.drawMoves()}async getOpeningName(){var e;try{const o=this.game.history({verbose:!0}).map(s=>s.lan).join(",");return((e=(await(await fetch(`https://explorer.lichess.ovh/masters?play=${o}`)).json()).opening)==null?void 0:e.name)??null}catch{return null}}move(e){let o;try{o=this.game.move(e)}catch{return typeof e=="object"&&this.board.state.movable.free&&(this.board.move(e.from,e.to),this.updateGameState({updateFen:!1})),!1}return this.emit("move",o),o!=null&&o.promotion&&this.emit("promotion",{color:_e(o.color),promotedTo:o.promotion.toUpperCase(),sanMove:o.san}),this.boardState.historyViewerState.isEnabled||(this.board.move(o.from,o.to),(o.flags==="e"||o!=null&&o.promotion)&&setTimeout(()=>this.board.set({fen:o.after}),this.board.state.animation.current?this.board.state.animation.duration:0),this.updateGameState({updateFen:!1}),Xt(this.board.playPremove)),!0}getTurnColor(){return _e(this.game.turn())}getPossibleMoves(){return Je(this.game)}getCurrentTurnNumber(){return this.game.moveNumber()}getCurrentPlyNumber(){return 2*this.getCurrentTurnNumber()-(this.getTurnColor()==="black"?1:2)}getLastMove(){return this.game.history({verbose:!0}).at(-1)}getHistory(e=!1){return this.game.history({verbose:e})}getFen(){return this.game.fen()}getBoardPosition(){return this.game.board()}getPgn(){return this.game.pgn()}getIsGameOver(){return this.game.isGameOver()}getIsCheckmate(){return this.game.isCheckmate()}getIsCheck(){return this.game.isCheck()}getIsStalemate(){return this.game.isStalemate()}getIsDraw(){return this.game.isDraw()}getIsThreefoldRepetition(){return this.game.isThreefoldRepetition()}getIsInsufficientMaterial(){return this.game.isInsufficientMaterial()}getSquareColor(e){return this.game.squareColor(e)}getSquare(e){return this.game.get(e)}setPosition(e){this.game.load(e),this.boardState.historyViewerState={isEnabled:!1},this.updateGameState()}putPiece(e,o){if(this.board.state.movable.free){const s=this.board.state.pieces;return s.set(o,{color:e.color==="w"?"white":"black",role:ko[e.type]}),this.board.setPieces(s),!0}else{const s=this.game.put(e,o);return s&&this.updateGameState(),s}}clearBoard(){this.game.clear(),this.boardState.historyViewerState={isEnabled:!1},this.updateGameState()}setShapes(e){this.board.setShapes(e)}loadPgn(e){this.game.loadPgn(e),this.boardState.historyViewerState={isEnabled:!1},this.updateGameState();const o=this.getLastMove();o&&this.board.set({lastMove:[o.from,o.to]})}getPgnInfo(){return this.game.header()}setPgnInfo(e){return this.game.header(...Object.entries(e).flat())}setConfig(e,o=!1){var n;if(o&&(e=mt(Eo,e),this.board.state.selected=void 0),((n=e.movable)==null?void 0:n.events)&&"after"in e.movable.events){const r=e.movable.events.after;e.movable.events.after=r?async(...a)=>{await this.changeTurn(...a),r(...a)}:this.changeTurn.bind(this)}const{fen:s,...i}=e;this.board.set(i),s&&this.setPosition(s),this.board.redrawAll()}viewHistory(e){const o=this.getHistory(!0);if(e<0||e>o.length)return;const s=this.board.state.animation.enabled&&(this.boardState.historyViewerState.isEnabled&&Math.abs(this.boardState.historyViewerState.plyViewing-e)!==1||!this.boardState.historyViewerState.isEnabled&&e!==o.length-1);if(s&&this.board.set({animation:{enabled:!1}}),e<o.length)this.boardState.historyViewerState.isEnabled?this.boardState.historyViewerState.plyViewing=e:this.boardState.historyViewerState={isEnabled:!0,plyViewing:e,viewOnly:this.board.state.viewOnly},this.board.set({fen:o[e].before,viewOnly:!0,lastMove:e>0?[o[e-1].from,o[e-1].to]:void 0,selected:void 0}),this.displayInCheck(e>0?"+#".includes(o[e-1].san.at(-1)):!1,_e(o[e].color)),this.board.cancelPremove();else if(this.boardState.historyViewerState.isEnabled){const i=o.at(-1);this.board.set({fen:i.after,viewOnly:this.boardState.historyViewerState.viewOnly,lastMove:[i.from,i.to]}),this.boardState.historyViewerState={isEnabled:!1},this.updateGameState({updateFen:!1})}s&&this.board.set({animation:{enabled:!0}})}stopViewingHistory(){this.boardState.historyViewerState.isEnabled&&this.viewHistory(this.getCurrentPlyNumber())}viewStart(){this.viewHistory(0)}viewNext(){this.boardState.historyViewerState.isEnabled&&this.viewHistory(this.boardState.historyViewerState.plyViewing+1)}viewPrevious(){const e=this.boardState.historyViewerState.isEnabled?this.boardState.historyViewerState.plyViewing:this.getCurrentPlyNumber();this.viewHistory(e-1)}}const Hs={class:"main-board"},Qs=ct({__name:"TheChessboard",props:{boardConfig:{default:()=>({})},playerColor:{},reactiveConfig:{type:Boolean,default:!1}},emits:["boardCreated","check","checkmate","stalemate","draw","promotion","move"],setup(t,{emit:e}){const o=t,s=ue(null),i=ze({showThreats:!1,promotionDialogState:{isEnabled:!1},historyViewerState:{isEnabled:!1}});return ht(()=>{if(s.value==null)throw new Error("vue3-chessboard: Failed to mount board.");const n=new Gt(s.value,i,o,e);if(e("boardCreated",n),o.reactiveConfig){let r=ye(o.boardConfig);Zt(ze(o.boardConfig),a=>{n.setConfig(bt(r,a)),r=ye(a)})}}),(n,r)=>(F(),Z("section",{class:Re(["main-wrap",{disabledBoard:i.promotionDialogState.isEnabled,viewingHistory:i.historyViewerState.isEnabled}])},[C("div",Hs,[i.promotionDialogState.isEnabled?(F(),dt(so,{key:0,state:i.promotionDialogState,onPromotionSelected:r[0]||(r[0]=a=>i.promotionDialogState={isEnabled:!1})},null,8,["state"])):ut("",!0),C("div",{ref_key:"boardElement",ref:s},null,512)])],2))}}),Us={id:"modalEl",tabindex:"-1","aria-hidden":"true",class:"fixed top-0 left-0 right-0 z-50 hidden w-full p-4 overflow-x-hidden overflow-y-auto md:inset-0 h-[calc(100%-1rem)] max-h-full"},Gs={class:"relative w-full max-w-[400px] max-h-full"},zs={class:"relative bg-[#414141] ring-accent ring-2 rounded-lg shadow dark:bg-gray-700"},Ys={class:"flex relative items-start justify-between p-5 rounded-t dark:border-gray-600"},Zs={class:"text-xl font-bold text-center w-full text-my-white lg:text-2xl dark:text-white"},Xs=C("svg",{class:"w-3 h-3","aria-hidden":"true",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 14 14"},[C("path",{stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"m1 1 6 6m0 0 6 6M7 7l6-6M7 7l-6 6"})],-1),Js=C("span",{class:"sr-only"},"Close modal",-1),ei=[Xs,Js],ti={class:"flex justify-center items-center p-6 space-x-2 rounded-b dark:border-gray-600"},oi={__name:"WinnerModal",props:{showModal:{type:Boolean,default:!1},winner:{type:String,default:null}},setup(t,{emit:e}){const o=ue(null);ht(()=>{const r=document.getElementById("modalEl"),a={backdrop:"dynamic",backdropClasses:"bg-gray-900/50 dark:bg-gray-900/80 fixed inset-0 z-40",closable:!1};o.value=new Jt(r,a),o.value.toggle()});const s=e;function i(){o.value.hide(),s("rematch")}function n(){o.value.hide(),s("closeModal")}return(r,a)=>(F(),Z("div",Us,[C("div",Gs,[C("div",zs,[C("div",Ys,[C("h3",Zs,re(t.winner==="b"?r.$t("You lost!"):r.$t("You Won!")),1),C("button",{type:"button",onClick:n,class:"text-my-white absolute top-[50%] translate-y-[calc(-50%)] right-5 bg-transparent hover:bg-gray-200 hover:text-gray-900 rounded-lg text-sm w-8 h-8 ml-auto inline-flex justify-center items-center dark:hover:bg-gray-600 dark:hover:text-white"},ei)]),C("div",ti,[C("button",{type:"button",onClick:i,class:"text-white bg-accent hover:bg-accent/80 focus:ring-4 focus:outline-none focus:ring-blue-300 font-medium rounded-lg text-sm px-5 py-2.5 text-center dark:bg-blue-600 dark:hover:bg-blue-700 dark:focus:ring-blue-800"},re(r.$t("New game")),1),C("button",{type:"button",onClick:n,class:"text-gray-500 bg-white hover:bg-gray-100 focus:ring-4 focus:outline-none focus:ring-blue-300 rounded-lg text-sm font-medium px-5 py-2.5 hover:text-gray-900 focus:z-10 dark:bg-gray-700 dark:text-gray-300 dark:border-gray-500 dark:hover:text-white dark:hover:bg-gray-600"},re(r.$t("Close")),1)])])])]))}};class si{constructor(e){this._stockfish,this._boardApi=e,this.bestMove,this.engineName;const o=typeof WebAssembly=="object"&&WebAssembly.validate(Uint8Array.of(0,97,115,109,1,0,0,0));this._stockfish=new Worker(o?"stockfish.wasm.js":"stockfish.js"),this._setupListeners(),this._stockfish.postMessage("uci")}_setupListeners(){this._stockfish.addEventListener("message",e=>this._handleEngineStdout(e)),this._stockfish.addEventListener("error",e=>console.error(e)),this._stockfish.addEventListener("messageerror",e=>console.error(e))}_handleEngineStdout(e){const o=e.data.split(" ");if(o[0]==="uciok"){this._setOption("UCI_AnalyseMode","true"),this._setOption("Analysis Contempt","Off"),this._stockfish.postMessage("ucinewgame"),this._stockfish.postMessage("isready");return}if(o[0]==="readyok"){this._stockfish.postMessage("go movetime 1500");return}o[0]==="bestmove"&&o[1]&&o[1]!==this.bestMove&&(this.bestMove=o[1],this._boardApi.getTurnColor()==="black"&&this._boardApi.move({from:this.bestMove.slice(0,2),to:this.bestMove.slice(2,4)}))}_setOption(e,o){this._stockfish.postMessage(`setoption name ${e} value ${o}`)}sendPosition(e){this._stockfish.postMessage(`position startpos moves ${e}`),this._stockfish.postMessage("go movetime 500")}}const ii={class:"grid gap-[20px]"},ni={class:"flex items-baseline gap-[3px]"},ri={class:"py-[4px]"},ai={id:"chess-move-notation",class:"max-w-[250px] w-full overflow-x-scroll"},li={class:"flex items-baseline gap-[3px] moves-holder"},ci={__name:"Board",setup(t){const e={coordinates:!0,width:300},o=ue(!1),s=ue(null);let i,n;function r(h=Gt){i=h,n=new si(h),n._setOption("Skill Level",10);const g=document.getElementsByTagName("cg-board");g[0].style.background="url(https://i.postimg.cc/j5H70b6C/chessboard.png)",g[0].style.backgroundSize="contain"}function a(){o.value=!1,c.value=null,i==null||i.resetBoard(),r()}function l(h){h==="w"?s.value="w":s.value="b",setTimeout(()=>{o.value=!0},2e3)}const c=ue(null),p=()=>{const h=i==null?void 0:i.getHistory(!0);c.value=h==null?void 0:h.map(d=>({san:d.san,color:d.color}));const g=h==null?void 0:h.map(d=>typeof d=="object"?d.lan:d);g&&(n==null||n.sendPosition(g.join(" "))),u()};function u(){setTimeout(()=>{const h=document.querySelector("#chess-move-notation"),g=document.querySelector(".moves-holder");h.scrollLeft=g.getClientRects()[0].width},1)}return(h,g)=>(F(),Z(Ne,null,[o.value?(F(),dt(oi,{key:0,winner:s.value,onCloseModal:g[0]||(g[0]=d=>o.value=!1),onRematch:a},null,8,["winner"])):ut("",!0),C("div",ii,[C("div",null,re(h.$t("Play chess with me!")),1),C("div",ni,[C("span",ri,re(h.$t("Moves"))+":",1),C("div",ai,[C("div",li,[(F(!0),Z(Ne,null,pt(c.value,(d,f)=>(F(),Z("div",{class:Re(`player-move player-${d.color}`),key:f},re(d.san),3))),128))])])]),ft(eo(Qs),{onBoardCreated:r,"board-config":e,onMove:g[1]||(g[1]=d=>p()),onCheckmate:l})])],64))}},hi={class:"container mx-auto grid gap-[50px] md:gap-[80px]"},pi={__name:"Chess",setup(t){return(e,o)=>(F(),Z("main",hi,[ft(ci)]))}};export{pi as default};
